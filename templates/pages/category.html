{% extends "base.html" %}
{% block meta_data %}
{% set base_url = SITE_URL or 'https://nationalbusiness.kz' %}

<title>
  {% if category.seo_title %}
    {{ category.seo_title }}
  {% else %}
    Рубрика новостей {{ category.title }} | nationalbusiness.kz
  {% endif %}
</title>

<link rel="canonical" href="{{ base_url }}/category/{{ category.slug }}/"/>
<meta name="description"
      content="{% if category.description %}{{ category.description }}{% else %}Материалы рубрики {{ category.title }} официально на nationalbusiness.kz{% endif %}" />
<meta name="keywords" content="категории {{ category.title }}"/>
<meta name="author" content="Редакция nationalbusiness.kz" />

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "CollectionPage",
  "name": "{{ category.title }}",
  "description": "{{ (category.description|striptags|e or ('Материалы рубрики ' ~ category.title ~ ' на nationalbusiness.kz')) }}",
  "url": "{{ base_url }}/category/{{ category.slug }}/",
  "mainEntity": {
    "@type": "ItemList",
    "itemListElement": [
      {% for article in page.items %}
      {
        "@type": "ListItem",
        "position": {{ loop.index }},
        "url": "{{ base_url }}/news/{{ article.alias }}/",
        "name": "{{ article.title|striptags|e }}"
      }{% if not loop.last %},{% endif %}
      {% endfor %}
    ]
  }
}
</script>

{# — JSON-LD: BreadcrumbList — #}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position": 1,
      "name": "Главная",
      "item": "{{ base_url }}/"
    },
    {
      "@type": "ListItem",
      "position": 2,
      "name": "{{ category.title|e }}",
      "item": "{{ base_url }}/category/{{ category.slug }}/"
    }
  ]
}
</script>

{% endblock meta_data %}

{% block content %}
  {% include 'header.html' %}

  {% if is_parent_category %}
    {% include 'category_parent.html' %}
  {% else %}
    {% include 'category_sub.html' %}
  {% endif %}

  {% include 'footer.html' %}
{% endblock content %}

{% block scripts %}
  <script type="module" crossorigin src="/static/scripts/main.js?v=1.1"></script>
{% endblock scripts %}